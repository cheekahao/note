<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>编译原理 | 前端笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="learning notebook of cheeka">
    
    <link rel="preload" href="/assets/css/0.styles.89a87d7c.css" as="style"><link rel="preload" href="/assets/js/app.4ffcedcb.js" as="script"><link rel="preload" href="/assets/js/3.a213aa8f.js" as="script"><link rel="preload" href="/assets/js/15.b893f62b.js" as="script"><link rel="prefetch" href="/assets/js/10.3c347e54.js"><link rel="prefetch" href="/assets/js/11.9adc9c77.js"><link rel="prefetch" href="/assets/js/12.c74c6a2c.js"><link rel="prefetch" href="/assets/js/13.9bfac093.js"><link rel="prefetch" href="/assets/js/14.8201ea59.js"><link rel="prefetch" href="/assets/js/16.fe2643ba.js"><link rel="prefetch" href="/assets/js/17.7711ce1c.js"><link rel="prefetch" href="/assets/js/18.8355d792.js"><link rel="prefetch" href="/assets/js/19.10d660f8.js"><link rel="prefetch" href="/assets/js/20.b252f2f1.js"><link rel="prefetch" href="/assets/js/21.72cd72b5.js"><link rel="prefetch" href="/assets/js/22.36e20d02.js"><link rel="prefetch" href="/assets/js/23.36e1d6bf.js"><link rel="prefetch" href="/assets/js/24.fa1933ff.js"><link rel="prefetch" href="/assets/js/25.7e9f2526.js"><link rel="prefetch" href="/assets/js/26.502733bd.js"><link rel="prefetch" href="/assets/js/27.37687208.js"><link rel="prefetch" href="/assets/js/28.47ac5267.js"><link rel="prefetch" href="/assets/js/29.2ea8973e.js"><link rel="prefetch" href="/assets/js/30.63a8a364.js"><link rel="prefetch" href="/assets/js/31.a0e0a094.js"><link rel="prefetch" href="/assets/js/32.3ffc993b.js"><link rel="prefetch" href="/assets/js/33.53d493cc.js"><link rel="prefetch" href="/assets/js/34.885e33aa.js"><link rel="prefetch" href="/assets/js/35.0b5bb67c.js"><link rel="prefetch" href="/assets/js/36.8b840a3d.js"><link rel="prefetch" href="/assets/js/37.c9149af4.js"><link rel="prefetch" href="/assets/js/38.af7e0ce7.js"><link rel="prefetch" href="/assets/js/39.4d90f037.js"><link rel="prefetch" href="/assets/js/4.212f9d7f.js"><link rel="prefetch" href="/assets/js/40.3272e3fd.js"><link rel="prefetch" href="/assets/js/5.9d6b8bce.js"><link rel="prefetch" href="/assets/js/6.f8a656cd.js"><link rel="prefetch" href="/assets/js/7.26d11c39.js"><link rel="prefetch" href="/assets/js/8.365efa03.js"><link rel="prefetch" href="/assets/js/9.60a6bc0a.js"><link rel="prefetch" href="/assets/js/vendors~mermaid.d4b5f89a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.89a87d7c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
    首页
  </a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fe/css.html" class="nav-link">
    css
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/es6/" class="nav-link">
    ES6
  </a></li><li class="dropdown-item"><!----> <a href="/javascript/omission.html" class="nav-link">
    JS拾遗
  </a></li><li class="dropdown-item"><!----> <a href="/javascript/ts.html" class="nav-link">
    TypeScript
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/vue.html" class="nav-link">
    Vue
  </a></li><li class="dropdown-item"><!----> <a href="/framework/vue3/" class="nav-link">
    Vue3源码解读
  </a></li><li class="dropdown-item"><!----> <a href="/framework/react.html" class="nav-link">
    React
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络" class="mobile-dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/http.html" class="nav-link">
    HTTP
  </a></li><li class="dropdown-item"><!----> <a href="/network/caching.html" class="nav-link">
    缓存
  </a></li></ul></div></div><div class="nav-item"><a href="/engineering/" class="nav-link">
    工程化
  </a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/functional.html" class="nav-link">
    函数式编程
  </a></li><li class="dropdown-item"><!----> <a href="/advance/patterns.html" class="nav-link">
    设计模式
  </a></li><li class="dropdown-item"><!----> <a href="/advance/architecture.html" class="nav-link">
    软件架构
  </a></li><li class="dropdown-item"><!----> <a href="/advance/algorithm.html" class="nav-link">
    数据结构
  </a></li><li class="dropdown-item"><!----> <a href="/advance/leet_code.html" class="nav-link">
    LeetCode
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/garbage-collection.html" class="nav-link">
    垃圾回收
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机科学" class="mobile-dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/program.html" class="nav-link">
    程序是怎么跑起来的
  </a></li><li class="dropdown-item"><!----> <a href="/cs/compiler.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
    编译原理
  </a></li></ul></div></div><div class="nav-item"><a href="https://github.com/cheekahao/learning" target="_blank" rel="noopener noreferrer" class="nav-link external">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
    首页
  </a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fe/css.html" class="nav-link">
    css
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/es6/" class="nav-link">
    ES6
  </a></li><li class="dropdown-item"><!----> <a href="/javascript/omission.html" class="nav-link">
    JS拾遗
  </a></li><li class="dropdown-item"><!----> <a href="/javascript/ts.html" class="nav-link">
    TypeScript
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/vue.html" class="nav-link">
    Vue
  </a></li><li class="dropdown-item"><!----> <a href="/framework/vue3/" class="nav-link">
    Vue3源码解读
  </a></li><li class="dropdown-item"><!----> <a href="/framework/react.html" class="nav-link">
    React
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络" class="mobile-dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/http.html" class="nav-link">
    HTTP
  </a></li><li class="dropdown-item"><!----> <a href="/network/caching.html" class="nav-link">
    缓存
  </a></li></ul></div></div><div class="nav-item"><a href="/engineering/" class="nav-link">
    工程化
  </a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/functional.html" class="nav-link">
    函数式编程
  </a></li><li class="dropdown-item"><!----> <a href="/advance/patterns.html" class="nav-link">
    设计模式
  </a></li><li class="dropdown-item"><!----> <a href="/advance/architecture.html" class="nav-link">
    软件架构
  </a></li><li class="dropdown-item"><!----> <a href="/advance/algorithm.html" class="nav-link">
    数据结构
  </a></li><li class="dropdown-item"><!----> <a href="/advance/leet_code.html" class="nav-link">
    LeetCode
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/garbage-collection.html" class="nav-link">
    垃圾回收
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机科学" class="mobile-dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/program.html" class="nav-link">
    程序是怎么跑起来的
  </a></li><li class="dropdown-item"><!----> <a href="/cs/compiler.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
    编译原理
  </a></li></ul></div></div><div class="nav-item"><a href="https://github.com/cheekahao/learning" target="_blank" rel="noopener noreferrer" class="nav-link external">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cs/compiler.html" aria-current="page" class="active sidebar-link">编译原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/compiler.html#c程序的运行式结构" class="sidebar-link">C程序的运行式结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/compiler.html#程序加载时的内存概况" class="sidebar-link">程序加载时的内存概况</a></li><li class="sidebar-sub-header"><a href="/cs/compiler.html#程序运行过程中的内存变化" class="sidebar-link">程序运行过程中的内存变化</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs/compiler.html#汇编中的寄存器" class="sidebar-link">汇编中的寄存器</a></li><li class="sidebar-sub-header"><a href="/cs/compiler.html#编译过程概述" class="sidebar-link">编译过程概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/compiler.html#词法分析" class="sidebar-link">词法分析</a></li><li class="sidebar-sub-header"><a href="/cs/compiler.html#语法分析" class="sidebar-link">语法分析</a></li><li class="sidebar-sub-header"><a href="/cs/compiler.html#从语法树到中间代码再到目标代码" class="sidebar-link">从语法树到中间代码再到目标代码</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="编译原理"><a href="#编译原理" class="header-anchor">#</a> 编译原理</h1> <blockquote><p>《编译系统透视：图解编译原理》读书笔记</p></blockquote> <h2 id="c程序的运行式结构"><a href="#c程序的运行式结构" class="header-anchor">#</a> C程序的运行式结构</h2> <p>C程序运行的核心是函数的执行和调用，它构成了整个C程序运行时结构的基础框架。这一运行过程主要是在程序指令的驱动以及数据压栈、清栈的支持下实现的。</p> <p>以下面的程序为例：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> c<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    c<span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="程序加载时的内存概况"><a href="#程序加载时的内存概况" class="header-anchor">#</a> 程序加载时的内存概况</h3> <p>运行时，在内存中，共有代码区、静态数据区和动态数据区三个区域。</p> <p><img src="//img.haozhenjia.com/blog/code_memory.jpg" alt="内存区域"></p> <p>其中，<strong>代码区</strong>装载了程序所对应的机器指令；全局变量<code>m</code>的数值装载在<strong>静态数据区</strong>中；<strong>动态数据区</strong>加载程序运行过程中产生的数据。</p> <p>程序执行的本质就是代码区的指令不断执行，驱使动态数据区和静态数据区产生数据变化。</p> <p><code>CPU</code>中有三个寄存器，分别是<code>eip</code>、<code>ebp</code>和<code>esp</code>。</p> <p><code>eip</code>永远指向代码区将要执行的下一条指令，它的管控方式有两种，一种是“顺序执行”，即程序执行完一条指令后自动指向下一条执行；另一种是跳转，也就是执行完一条跳转指令后跳转到指定的位置。</p> <p><code>ebp</code>和<code>esp</code>用来管控栈空间，<code>ebp</code>指向栈底，<code>esp</code>指向栈顶。在代码区中，函数调用、返回和执行伴随着不断压栈和清栈，栈中数据存储和释放的原则是后进先出。</p> <p><code>eip</code>指向<code>main</code>函数的第一条指令，此时程序还没有运行，栈空间里还没有数据，ebp和esp指向的位置是程序加载时内核设置的。</p> <h3 id="程序运行过程中的内存变化"><a href="#程序运行过程中的内存变化" class="header-anchor">#</a> 程序运行过程中的内存变化</h3> <p>程序开始执行<code>main</code>函数第一条指令(<code>call</code>指令)，<code>eip</code>自动指向下一条指令。第一条指令的执行，致使<code>ebp</code>的地址值被保存在栈中，保存的目的是本程序执行完毕后，<code>ebp</code>还能返回现在的位置，复原现在的栈。</p> <p>随着<code>ebp</code>地址值的压栈，<code>esp</code>自动向栈顶方向移动，它将永远指向栈顶。</p> <p>接下来，开始构建<code>main</code>函数自己的栈，<code>ebp</code>原来指向的地址值已经被保存了，此时和<code>esp</code>是重叠的，用来看管main函数的栈底。</p> <h2 id="汇编中的寄存器"><a href="#汇编中的寄存器" class="header-anchor">#</a> 汇编中的寄存器</h2> <p><code>eax</code>, <code>ebx</code>, <code>ecx</code>, <code>edx</code>, <code>esi</code>, <code>edi</code>, <code>ebp</code>, <code>esp</code>等都是<code>X86</code>汇编语言中<code>CPU</code>上的通用寄存器的名称，是32位的寄存器。</p> <p>如果用C语言来解释，可以把这些寄存器当作变量看待。</p> <table><thead><tr><th>汇编名称</th> <th>寄存器类型</th> <th>作用</th></tr></thead> <tbody><tr><td><code>EAX</code></td> <td>累加寄存器<code>accumulator register</code></td> <td>加法乘法指令的缺省寄存器</td></tr> <tr><td><code>EBX</code></td> <td>基址寄存器<code>base register</code></td> <td>内存寻址时存放基地址</td></tr> <tr><td><code>ECX</code></td> <td>程序计数器<code>program counter</code></td> <td>重复<code>REP</code>前缀指令和<code>LOOP</code>指令的内定计数器</td></tr> <tr><td><code>EDX</code></td> <td></td> <td>用来存放整数除法产生的余数</td></tr> <tr><td><code>ESI</code></td> <td>源索引寄存器<code>source index</code></td> <td>在很多字符串操作指令中, <code>DS:ESI</code>指向源串</td></tr> <tr><td><code>EDI</code></td> <td>目标索引寄存器<code>destination index</code></td> <td>在很多字符串操作指令中, <code>ES:EDI</code>指向目标串</td></tr> <tr><td><code>EBP</code></td> <td>基址指针<code>base pointer</code></td> <td>常被用作高级语言函数调用的<strong>框架指针<code>frame pointer</code></strong>，存放当前线程的栈底指针</td></tr> <tr><td><code>ESP</code></td> <td>堆栈指针</td> <td>存放当前线程的栈顶指针，堆栈的顶部是地址小的区域，压入堆栈的数据越多，ESP也就越来越小。</td></tr> <tr><td><code>EIP</code></td> <td>指令寄存器<code>instrution register</code></td> <td>存放下一个<code>CPU</code>指令存放的内存地址</td></tr></tbody></table> <p>因此，在函数的起始部分经常有：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>push ebp; 保存当前ebp
mov ebp, esp; EBP设为当前堆栈指针
sub esp, xxx; 预留xxx字节给函数临时变量.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="编译过程概述"><a href="#编译过程概述" class="header-anchor">#</a> 编译过程概述</h2> <p>源程序是给人看的，本质上就是文本文件。需要通过<strong>编译器</strong><code>Compiler</code>将源程序编译为计算机可执行的程序。</p> <p>编译过程主要分为词法分析、语法分析、中间代码生成、目标代码生成四个过程。</p> <h3 id="词法分析"><a href="#词法分析" class="header-anchor">#</a> 词法分析</h3> <p>词法分析的作用是从连续的字符中识别出标识符、关键字、数字、运算符并存储为符号<code>token</code>流。</p> <p>词法分析器<code>Lexer</code>，也叫扫描器<code>Scanner</code>，重要功能是根据对应语言的语法规则，一个字符一个字符从源程序的字符串中识别出一个个的符号<code>token</code>，并按序保存。</p> <p>C语言的语法规则是由一个<strong>状态转换图</strong>实现的。</p> <p>在词法分析阶段，词法分析器能够识别出一些符号的含义，包括关键字、数字、字符串、分隔符、运算符等，但是另外一切符号需要通过前后其他符号才能确定准确含义，仅能初步判断是一个标识符，更多详细信息在语法分析阶段完成。</p> <h3 id="语法分析"><a href="#语法分析" class="header-anchor">#</a> 语法分析</h3> <p>语法分析的作用是从词法分析识别出的<strong>token流</strong>中识别出符合对应语言语法的语句。</p> <p>语法分析器<code>Parser</code>依据用计算机表示的语法，一个符号一个符号地识别出符合C语言语法的语句。</p> <p>在语法分析器中把通过产生式产生的对应语言语法映射成一套模板，并把这套模板融汇在语法分析器的程序中。语法分析器的作用就是将词法分析器识别出的符号<code>token</code>一个一个地与这套模板进行匹配，匹配上这套模板中的某个语法，就可以识别出一句完整的语句，并确定这条语句的语法。</p> <p>语法的计算机表示就是产生式。</p> <p>语法分析器的最终输出是语法树<code>AST</code>，是一个二维结构。语法树已经承载了源程序的全部信息，后续的转换工作就和源程序没关系了。</p> <h3 id="从语法树到中间代码再到目标代码"><a href="#从语法树到中间代码再到目标代码" class="header-anchor">#</a> 从语法树到中间代码再到目标代码</h3> <p>鉴于计算机存在着多种<code>CPU</code>硬件平台，考虑到程序在不同<code>CPU</code>之间的可移植性，需要先将语法树转换成一个通用的、抽象的<strong>CPU指令</strong>，这就是中间代码最初的设计思想。然后根据具体选定的<code>CPU</code>，将中间代码落实到具体<code>CPU</code>的目标代码。</p> <p>语法树是个二维结构，中间代码是准一维结构，语法树到中间代码的转换过程，本质上是将二维结构转换为准一维结构的过程。</p> <p>选定具体的<code>CPU</code>、操作系统后，中间代码就可以转换为目标代码——汇编代码。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4ffcedcb.js" defer></script><script src="/assets/js/3.a213aa8f.js" defer></script><script src="/assets/js/15.b893f62b.js" defer></script>
  </body>
</html>
