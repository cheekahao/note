"use strict";(self.webpackChunknote=self.webpackChunknote||[]).push([["8522"],{8704:function(e,n,s){s.r(n),s.d(n,{default:()=>l});var c=s(5893),d=s(65);function r(e){let n=Object.assign({h1:"h1",a:"a",code:"code",p:"p",h2:"h2",pre:"pre",ul:"ul",li:"li",strong:"strong"},(0,d.ah)(),e.components);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.h1,{id:"set和map",children:[(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#set和map",children:"#"}),(0,c.jsx)(n.code,{children:"Set"}),"和",(0,c.jsx)(n.code,{children:"Map"})]}),"\n",(0,c.jsxs)(n.p,{children:["长久以来，数组",(0,c.jsx)(n.code,{children:"Array"}),"一直是",(0,c.jsx)(n.code,{children:"JavaScript"}),"中唯一的集合类型，但是由于是数值型索引而在使用上受限。对于非数值类型索引的集合，就是",(0,c.jsx)(n.code,{children:"Set"}),"和",(0,c.jsx)(n.code,{children:"Map"}),"。"]}),"\n",(0,c.jsxs)(n.h2,{id:"基于对象实现的set和map",children:[(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#基于对象实现的set和map",children:"#"}),"基于对象实现的",(0,c.jsx)(n.code,{children:"Set"}),"和",(0,c.jsx)(n.code,{children:"Map"})]}),"\n",(0,c.jsxs)(n.p,{children:["在",(0,c.jsx)(n.code,{children:"ES6"}),"发布之前，开发者以及基于非数组对象实现了类似的功能："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// set\n\nvar set = Object.create(null)\n\nset.foo = true\n\nif(set.foo){\n    // do something\n}\n\n// map\n\nvar map = Object.create(null)\n\nset.foo = 'bar'\n\nvar value = map.foo\n\n// do something\n"})}),"\n",(0,c.jsx)(n.p,{children:"上述解决方案存在以下一些问题："}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["对象的属性必须是字符串类型，所以",(0,c.jsx)(n.code,{children:'map["5"]'}),"和",(0,c.jsx)(n.code,{children:"map[5]"}),"引用的是同一个属性"]}),"\n",(0,c.jsxs)(n.li,{children:["对象类型会被转换成",(0,c.jsx)(n.code,{children:'"[object Object]"'}),"，会出现错误"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"map"}),"中值为",(0,c.jsx)(n.code,{children:"False"}),"类的值，直接",(0,c.jsx)(n.code,{children:"if"}),"判断会存在",(0,c.jsx)(n.code,{children:"bug"}),"，使用",(0,c.jsx)(n.code,{children:"in"}),"操作符会检索对象的原型，需要保证对象的原型为",(0,c.jsx)(n.code,{children:"null"})]}),"\n"]}),"\n",(0,c.jsxs)(n.h2,{id:"es6中的set和weakset",children:[(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#es6中的set和weakset",children:"#"}),(0,c.jsx)(n.code,{children:"ES6"}),"中的",(0,c.jsx)(n.code,{children:"Set"}),"和",(0,c.jsx)(n.code,{children:"WeakSet"})]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Set"}),"是一种",(0,c.jsx)(n.strong,{children:"有序列表"}),"，其中含有一些相互独立的非重复值。通过",(0,c.jsx)(n.code,{children:"Set"}),"集合可以快速访问其中的数据，更加有效的追踪各种离散值"]}),"\n",(0,c.jsxs)(n.p,{children:["将对象存储在",(0,c.jsx)(n.code,{children:"Set"}),"中，与存储在变量中完全一样，只要改实例存在，垃圾回收机制就不能释放该对象的内存空间，可以被看做是一个强引用的",(0,c.jsx)(n.code,{children:"Set"}),"集合。",(0,c.jsx)(n.code,{children:"WeakSet"}),"则是",(0,c.jsx)(n.strong,{children:"弱引用集合"}),"，只存储对象的弱引用，并且不可以存储原始值，集合中的弱引用如果是对象的唯一引用，该对象可以正常被垃圾回收。"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"两者的区别"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["在",(0,c.jsx)(n.code,{children:"WeakSet"}),"中，通过",(0,c.jsx)(n.code,{children:"add()"}),"方法添加非对象参数会报错，",(0,c.jsx)(n.code,{children:"has()"}),"和",(0,c.jsx)(n.code,{children:"delete()"}),"方法会返回",(0,c.jsx)(n.code,{children:"false"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"WeakSet"}),"不可迭代，不能用于",(0,c.jsx)(n.code,{children:"for-of"}),"循环"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"WeakSet"}),"不暴露任何迭代器方法(",(0,c.jsx)(n.code,{children:"keys()"}),"和",(0,c.jsx)(n.code,{children:"values()"}),")，无法通过程序本身来检测其中的内容"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"WeakSet"}),"不支持",(0,c.jsx)(n.code,{children:"forEach()"}),"方法"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"WeakSet"}),"不支持",(0,c.jsx)(n.code,{children:"size"}),"属性"]}),"\n"]})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,d.ah)(),e.components);return n?(0,c.jsx)(n,Object.assign({},e,{children:(0,c.jsx)(r,e)})):r(e)}let l=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["javascript%2Fes6%2Fset-map.md"]={toc:[{id:"基于对象实现的set和map",text:"基于对象实现的`Set`和`Map`",depth:2},{id:"es6中的set和weakset",text:"`ES6`中的`Set`和`WeakSet`",depth:2}],title:"`Set`和`Map`",headingTitle:"`Set`和`Map`",frontmatter:{}}}}]);