"use strict";(self.webpackChunknote=self.webpackChunknote||[]).push([["8391"],{8763:function(e,r,d){d.r(r),d.d(r,{default:()=>l});var c=d(5893),t=d(65);function n(e){let r=Object.assign({h1:"h1",a:"a",p:"p",code:"code",blockquote:"blockquote",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",h2:"h2",pre:"pre"},(0,t.ah)(),e.components);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(r.h1,{id:"代理和反射",children:[(0,c.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#代理和反射",children:"#"}),"代理和反射"]}),"\n",(0,c.jsxs)(r.p,{children:["代理(Proxy)是一种可以拦截并改变底层",(0,c.jsx)(r.code,{children:"JavaScript"}),"引擎操作的包装器。"]}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsxs)(r.p,{children:["在",(0,c.jsx)(r.code,{children:"ES6"}),"中数组被认为是奇异对象(exotic object)"]}),"\n"]}),"\n",(0,c.jsxs)(r.p,{children:["调用",(0,c.jsx)(r.code,{children:"new Proxy"}),"可创建目标(target)对象的代理，他虚拟化了目标，二者看起来功能一致。"]}),"\n",(0,c.jsxs)(r.p,{children:["代理可以拦截",(0,c.jsx)(r.code,{children:"JavaScript"}),"引擎内部目标的底层对象操作，会触发对应的陷阱函数"]}),"\n",(0,c.jsxs)(r.p,{children:["反射",(0,c.jsx)(r.code,{children:"API"}),"以",(0,c.jsx)(r.code,{children:"Reflect"}),"对象的形式出现，对象中方法的默认特性与相同的底层操作一直，代理可以覆写这些操作，每个代理陷阱都对应一个命名和参数相同的",(0,c.jsx)(r.code,{children:"Reflect"}),"方法"]}),"\n",(0,c.jsxs)(r.table,{children:[(0,c.jsx)(r.thead,{children:(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.th,{children:"代理陷阱"}),(0,c.jsx)(r.th,{children:"覆写的特性"}),(0,c.jsx)(r.th,{children:"默认特性"})]})}),(0,c.jsxs)(r.tbody,{children:[(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"get"})}),(0,c.jsx)(r.td,{children:"读取一个属性值"}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.get()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"set"})}),(0,c.jsx)(r.td,{children:"写入一个属性值"}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.set()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"has"})}),(0,c.jsxs)(r.td,{children:[(0,c.jsx)(r.code,{children:"in"}),"操作符"]}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.has()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"deleteProperty"})}),(0,c.jsxs)(r.td,{children:[(0,c.jsx)(r.code,{children:"delete"}),"操作符"]}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.deleteProperty()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"getPrototypeOf"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.getPrototypeOf()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.getPrototypeOf()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"setPrototypeOf"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.setPrototypeOf()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.setPrototypeOf()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"isExtensible"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.isExtensible()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.isExtensible()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"preventExtensions"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.preventExtensions()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.preventExtensions()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"getOwnPropertyDescriptor"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.getOwnPropertyDescriptor()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.getOwnPropertyDescriptor()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"defineProperty"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Object.defineProperty()"})}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.defineProperty()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"ownKeys"})}),(0,c.jsxs)(r.td,{children:[(0,c.jsx)(r.code,{children:"Object.keys()"}),"、",(0,c.jsx)(r.code,{children:"Object.getOwnPropertyNames()"}),"和、",(0,c.jsx)(r.code,{children:"Object.getOwnPropertySymbols()"})]}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.ownKeys()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"apply"})}),(0,c.jsx)(r.td,{children:"调用一个函数"}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.apply()"})})]}),(0,c.jsxs)(r.tr,{children:[(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"construct"})}),(0,c.jsxs)(r.td,{children:["用",(0,c.jsx)(r.code,{children:"new"}),"调用一个函数"]}),(0,c.jsx)(r.td,{children:(0,c.jsx)(r.code,{children:"Reflect.construct()"})})]})]})]}),"\n",(0,c.jsxs)(r.h2,{id:"代理的使用",children:[(0,c.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#代理的使用",children:"#"}),"代理的使用"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:'let target = {}\nlet proxy = new Proxy(target, {\n    /**\n     * \n     * @param {Object}          trapTarget  接受属性的被代理的目标对象，本例中的target\n     * @param {String, Symbol}  key         要写入的属性键值\n     * @param {*}               value       要写入的属性键值\n     * @param {Object}          receiver    代理对象，本例中的proxy\n     */\n    set(trapTarget, key, value, receiver) {\n        console.log(trapTarget === target, key, value, receiver === proxy); // true \'name\' \'proxy\' true\n        \n        return Reflect.set(trapTarget, key, value, receiver)\n    },\n    get(trapTarget, key, receiver){\n        if( !(key in receiver) ){\n            throw new Error(`属性 ${key} 不存在`)\n        }\n        \n        return Reflect.get(trapTarget, key, receiver)\n    }\n})\n\nproxy.name = "proxy"\nconsole.log(proxy.name) // "proxy"\nconsole.log(target.name) // "proxy"\n'})}),"\n",(0,c.jsxs)(r.h2,{id:"浏览器支持程度",children:[(0,c.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#浏览器支持程度",children:"#"}),"浏览器支持程度"]}),"\n",(0,c.jsxs)(r.p,{children:["49以上版本Chrome支持",(0,c.jsx)(r.code,{children:"Proxy"}),"。",(0,c.jsx)(r.code,{children:"IE"}),"浏览器不支持。"]})]})}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,t.ah)(),e.components);return r?(0,c.jsx)(r,Object.assign({},e,{children:(0,c.jsx)(n,e)})):n(e)}let l=s;s.__RSPRESS_PAGE_META={},s.__RSPRESS_PAGE_META["javascript%2Fes6%2Fproxy.md"]={toc:[{id:"代理的使用",text:"代理的使用",depth:2},{id:"浏览器支持程度",text:"浏览器支持程度",depth:2}],title:"代理和反射",headingTitle:"代理和反射",frontmatter:{}}}}]);